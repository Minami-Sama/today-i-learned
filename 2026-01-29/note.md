# TIL: Twine (Harlowe 3.3.9) で Start 画面の中央寄せがズレる問題を直した

## 何が起きてた？

Twine/HarloweでビジュアルノベルのStart画面を作っていたら、

* `tw-passage`（字幕枠）自体は画面中央にあるのに
* **Start画面のテキストだけが微妙にズレて見える／左寄せになる**

という現象が出た。
`(align:"==><=")` を使っても、期待通りの中央にならないことがあった。

---

## まずやった切り分け（これが効いた）

「どこがズレているか」を視覚で確定するためにデバッグを入れた。

### 1) 画面センター線（赤）を表示

* 本当に画面の中心がどこか、曖昧な“目測”を捨てる。

### 2) `tw-passage` の枠線（緑）を表示

* 枠がズレているのか、中身だけズレているのかを切り分ける。

### 3) 文字は `■■■■■■` に置き換えて検証

* フォントの見え方・字形の錯覚を排除して「ブロックの中心」を見る。

---

## 結論：原因は「Start専用CSSが発火してなかった」

Startだけ中央寄せにしたいので、以下のCSSを使う設計にしていた：

* `tw-passage[tags~="start"] { ... }`

しかし、Startパッセージに **tag: `start` が付いていない**と、このCSSはそもそも当たらない。
その状態で `(align:)` などをいじっても、土台が左寄せのままなので期待通りになりにくい。

---

## 解決法（効いた最終形）

### 1) Startパッセージに tag `start` を付ける

TwineのStartパッセージ → Tags に `start` を追加。

### 2) CSSの一番下に「Start強制中央寄せ」を入れる

（将来ほかのCSSで上書きされても崩れにくい保険として `!important` を付ける）

```css
tw-passage[tags~="start"] { text-align: center !important; }
tw-passage[tags~="start"] * { text-align: center !important; }
```

---

## 検証（どっちが効いてた？）

切り分けのために以下を実施：

* **追加CSSをコメントアウト**しても中央OK
* **タグだけ外す**と左寄せに戻る

→ つまり「中央寄せが効いた本体」は **tag `start` が付いたこと**。
追加CSSは「将来の上書き事故を防ぐ保険」として残す判断にした。

---

## 学び（再発防止メモ）

* `tw-passage[tags~="X"]` 系のCSSは、**タグが付いてないと一生効かない**
* `(align:)` で無理に戦う前に、まず「CSSが当たってるか」を疑う
* デバッグ線（画面センター）＋枠線（コンテナ境界）は、ズレ問題を一撃で終わらせる

---

## 次やること（エタらない用）

UIは一旦勝ったので固定。
次は **Cルート本文のTwine化を進める**（UIを触り始めると無限に増えるので封印）。
